{% extends "AdminBundle::layout.html.twig" %}

{% block header %}
    {% embed 'AdminBundle::header.html.twig' %}
        {% block stylesheets %}
            {{ parent() }}
            <link href="{{ asset("css/admin-parameters-registration.css") }}" rel="stylesheet">
        {% endblock %}
    {% endembed %}
{% endblock %}

{% block main %}
    {{ render(controller('AdminBundle:Communication:sidebar',{'active':1})) }}

    <main class="col-md-9  offset-md-1 float-left main">

        <div class = "row">
            <div class = "col-12 col-md-12 sous-menu-main">
                <nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse menu-niv-3">
                    <ul class="content-menu-niv-3 hidden-lg-up">
                        <li class="nav-item-niv-3 form-inscription">
                            <a class="nav-link-niv-3 menu-page-active" href="{{ path("admin_communication_emailing_compaign") }}">campagnes </a>
                            <span class = "bulle-aide"></span>
                        </li>
                    </ul>
                    <div class="navbar-collapse collapse" id="collapsingNavbarFormInscription">
                        <ul class="navbar-nav content-menu-niv-3">
                            <li class="nav-item-niv-3 form-inscription hidden-md-down">
                                <a class="nav-link-niv-3 menu-page-active" href="{{ path("admin_communication_emailing_compaign") }}">campagnes </a>
                                <span class = "bulle-aide"></span>
                            </li>
                            <li class="nav-item-niv-3 form-inscription">
                                <a class="nav-link-niv-3 menu-page" href="{{ path("admin_communication_emailing_templates") }}">templates </a>
                                <span class = "bulle-aide"></span>
                            </li>
                            <li class="nav-item-niv-3 form-inscription">
                                <a class="nav-link-niv-3 menu-page" href="#">liste de diffusion </a>
                                <span class = "bulle-aide"></span>
                            </li>
                            <li class="nav-item-niv-3 form-inscription">
                                <a class="nav-link-niv-3 menu-page" href="#">rapports </a>
                                <span class = "bulle-aide"></span>
                            </li>
                            <li class="nav-item-niv-3 form-inscription">
                                <a class="nav-link-niv-3 menu-page" href="#">sur-mesures </a>
                                <span class = "bulle-aide"></span>
                            </li>
                        </ul>
                    </div>
                    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#collapsingNavbarFormInscription" style = "margin-right: 0;right: 0;color: #505050;border: 1px solid black;">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <a class="navbar-brand abs" href="#"></a>
                </nav>
            </div>
        </div>

        <div class = "row">
            <div class = "col-12 col-md-12">
                <section class="fieldset slideshow active">
                    <div class="row filter">
                        <div class="create">
                            <button class="btn-valider" data-toggle="modal" data-target="#new-campaign-modal">
                                créer une campagne
                            </button>
                        </div>
                        <div class="next-create">
                            <div class="dropdown dossiers">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuDossier" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-default="DOSSIERS">
                                    DOSSIERS
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuDossier">
                                    {% for folder in folders %}
                                        <a class="dropdown-item" href="#">
                                            {{ folder["name"] }}
                                            <span class="folder_count">{{ folder["count"] }}</span>
                                            <span class="folder_id">{{ folder["id"] }} </span>
                                        </a>
                                    {% endfor %}
                                </div>
                                <span class="delete-input"></span>
                            </div>
                            
                            <div class="dropdown filtres">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuFiltre" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-default="FILTRES">
                                    FILTRES
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuFiltre">
                                    <a class="dropdown-item" href="#">
                                        Date de création
                                        <span>create_time</span>
                                    </a>
                                    <a class="dropdown-item" href="#">
                                        Dernière mise à jour
                                        <span>send_time</span>
                                    </a>
                                </div>
                                <span class="delete-input"></span>
                            </div>

                            <div>
                                <a href="#" class="add add-folder-link" data-toggle="modal" data-target="#new-folder-modal-campaign">
                                    créer un dossier
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="row filter selected-campaign">
                        <div class="create campagne-count">
                            <div class="selected-count">
                                <input type="text" value="campagne sélectionnée">
                                <span class="delete-input"></span>
                            </div>
                        </div>
                        <div class="next-create campaign-delete-move">
                            <div class="dropdown move-to">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuDossier" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-default="DÉPLACER DANS DOSSIER">
                                    DÉPLACER DANS DOSSIER
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuDossier">
                                    {% for folder in folders %}
                                        <a class="dropdown-item" href="#">
                                            {{ folder["name"] }}
                                            <span class="folder_count">{{ folder["count"] }}</span>
                                            <span class="folder_id">{{ folder["id"] }} </span>
                                        </a>
                                    {% endfor %}
                                    <a href="#" class="add dropdown-item add-folder-link" data-toggle="modal" data-target="#new-folder-modal-campaign">
                                        créer un dossier
                                    </a>
                                </div>                                
                            </div>
                            <div class="campaign-delete">
                                <button class="btn-valider" class="btn btn-primary" data-toggle="modal" data-target="#delete-modal-campaign">
                                    supprimer
                                </button> 
                            </div>
                        </div>
                    </div> 
                    <div class="row list">
                        {% for li in list %}
                            <div class="row campaign-{{li.id}}">
                                <div class="campagne-name">
                                    <input type="checkbox" class="styled-checkbox bigger" id="{{li.id}}">
                                    <label for="{{li.id}}">
                                        <span></span>
                                        <div class="campagne-name-name">
                                            {{ li.settings["title"] }}
                                        </div>
                                        <div class="campagne-name-date">
                                            {{ li.status }} - {{ li.createTime | localizeddate('none', 'none', locale, null, "'le' d MMMM Y 'à' H:mm") }}
                                        </div>
                                    </label>                           
                                </div>
                                <div class="campagne-metric">
                                    <div class="metric-1">
                                        <span class="metric-value">
                                            {{ (li.recipients["recipient_count"] is defined)?li.recipients["recipient_count"]:0 }}
                                        </span>
                                        <span class="metric-desc">inscrits</span>
                                    </div>
                                    <div class="metric-2">
                                        <span class="metric-value">
                                            {{ (li.reportSummary["open_rate"] is defined)?li.reportSummary["open_rate"]:0 }} %
                                        </span>
                                        <span class="metric-desc">ouvertures</span>
                                    </div>
                                    <div class="metric-3">
                                        <span class="metric-value">
                                            {{ (li.reportSummary["click_rate"] is defined)?li.reportSummary["click_rate"]:0}} %
                                        </span>
                                        <span class="metric-desc">clics</span>
                                    </div>
                                </div>
                                <div class="campagne-action">
                                    <div class="dropdown">
                                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuAction" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-default="ACTIONS">
                                            ACTIONS
                                        </button>
                                        <div class="dropdown-menu" aria-labelledby="dropdownMenuAction">
                                            <a class="dropdown-item" href="#">VOIR LE RAPPORT</a>
                                            <a class="dropdown-item" href="#">VOIR EMAIL</a>
                                            <a class="dropdown-item campaign-rename" href="#">RENOMMER</a>
                                            <a class="dropdown-item campaign-replicate" href="#">DUPLIQUER</a>                                            
                                            <input type="hidden" name="campaign-id" value="{{ li.id }}">                                           
                                        </div>
                                    </div>
                                </div>                            
                            </div>
                        {% endfor %}                    
                    </div>                    
                    <div class="row ending">
                        
                    </div>  
                    {# modal new folder #}
                    <!-- Modal -->
                    <div id="new-folder-modal-campaign" class="modal bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <a class="close-modal" data-dismiss="modal" aria-label="Close"></a>
                                </div>
                                <div class="content">
                                    <div><h4>créer un dossier</h4></div>
                                    <div class="row btn-new-campaign-folder">
                                        <label for="campaign_new_folder">nom du dossier </label>
                                        <input id="campaign_new_folder" name="campaign_new_folder" value="" type="text">
                                    </div>                                
                                    <div class="row centered">
                                        <button class="btn-valider btn-new-campaign-folder">
                                            valider
                                        </button>
                                    </div>
                                    <div class="add-campaign-folder-error"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {# modal rename #}
                    <button type="button" id="btn-modal-rename" class="btn btn-primary" data-toggle="modal" data-target="#rename-modal-campaign"></button>
                    <!-- Modal dupliquer-->
                    <div id="rename-modal-campaign" class="modal bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <a class="close-modal" data-dismiss="modal" aria-label="Close"></a>
                                </div>
                                <div class="content">
                                    <div><h4>renommer la compaigne</h4></div>
                                    <div class="row btn-new-campaign-folder">
                                        <label for="campaign_new_name">nom de la compaigne </label>
                                        <input id="campaign_new_name" name="campaign_new_name" value="" type="text">
                                        <input name="campaign-id" type="hidden" value="">
                                    </div>                                
                                    <div class="row centered">
                                        <button class="btn-valider btn-rename-campaign">
                                            valider
                                        </button>
                                    </div>
                                    <div class="add-campaign-folder-error"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {#modal delete#}                    
                    <!-- Modal supprimer-->
                    <div id="delete-modal-campaign" class="modal bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <a class="close-modal" data-dismiss="modal" aria-label="Close"></a>
                                </div>
                                <div class="content">
                                    <div><h4>suppression</h4></div>
                                    <div class="row btn-new-campaign-folder">
                                        <label for="">Êtes-vous sûr de vouloir supprimer définitivement cette campagne ?</label>
                                    </div>                                
                                    <div class="row centered">
                                        <button class="btn-valider btn-delete-campaign">
                                            valider
                                        </button>
                                    </div>
                                    <div class="add-campaign-folder-error"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Modal créer nouveau-->                    
                    <div id="new-campaign-modal" class="modal bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-lg big" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <a class="close-modal" data-target="#suspend-new-campaign-modal" data-toggle="modal" aria-label="Close"></a>
                                </div>
                                <div class="content">
                                    <div><h4>créer une campagne</h4></div>

                                    <div class = "row">
                                        <div class= "col-12 col-md-12 navbar">
                                            <ul class="nav navbar-nav" id="create-tabs">
                                                <a class="activated done" data-toggle="tab"  href="#tab-form-level-1">
                                                    étape 1<br>
                                                    <span class="tab-spec">nom et objet de la campagne</span>
                                                    <span class="fullfilled"></span>
                                                </a>
                                                <a class="" data-toggle="tab"  href="#tab-form-level-2">
                                                    étape 2<br>
                                                    <span class="tab-spec">liste de diffusion</span>
                                                    <span class="fullfilled"></span>
                                                </a>
                                                <a class="" data-toggle="tab"  href="#tab-form-level-3">
                                                    étape 3<br>
                                                    <span class="tab-spec">template</span>
                                                    <span class="fullfilled"></span>
                                                </a>
                                                <a class="" data-toggle="tab"  href="#tab-form-level-4">
                                                    étape 4<br>
                                                    <span class="tab-spec">envoi de la campagne</span>
                                                    <span class="fullfilled"></span>
                                                </a>                                
                                            </ul>
                                        </div>
                                    </div>

                                    <div class = "row tab-content">                    
                                        <div class = "col-12 col-md-12 tab-pane" id="tab-form-level-1">
                                            <p class="form-line">
                                                <label>renseignez le nom de la campagne</label>
                                                <input type="text" value="">
                                                <span class="delete-input"></span>
                                            </p>
                                            <p class="form-line">
                                                <label>renseignez le nom de la campagne</label>
                                                <input type="text" value="">
                                                <span class="delete-input"></span>
                                            </p>
                                            <p>L'e-mail d'envoie de votre campagne sera : contact@monchallenge2017.sorewards.com</p>
                                            <p>
                                                Pour toute modification de cet e-mail veuillez <a href="#" class="nous-contactez">nous contacter</a>
                                            </p>

                                            <div class="row centered">
                                                <button class="btn-valider btn-delete-campaign">
                                                    continuer
                                                </button>
                                            </div>                                            
                                        </div>
                                        <div class = "col-12 col-md-12 tab-pane" id="tab-form-level-2">2
                                        </div>
                                        <div class = "col-12 col-md-12 tab-pane" id="tab-form-level-3">3
                                        </div>
                                        <div class = "col-12 col-md-12 tab-pane" id="tab-form-level-4">4
                                        </div>
                                    </div>                              
                                    
                                    <div class="add-campaign-folder-error"></div>
                                </div>
                            </div>
                        </div>
                    </div> 
                    <!-- Modal suspendre création nouveau-->                    
                    <div id="suspend-new-campaign-modal" class="modal bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-lg " role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <a class="close-modal" data-dismiss="modal" aria-label="Close"></a>
                                </div>
                                <div class="content">
                                    <div><h4>Suspendre la création d'une campagne</h4></div>
                                    <div class="row btn-new-campaign-folder">
                                        <label>Vous allez suspendre le processus de création d'une campagne. <br> Celle-ci va s'enregistrer dans la liste de vos campagnes, vous pourrrez ainsi l'éditer ultérieurement</label>
                                    </div>                                
                                    <div class="row centered">
                                        <button class="btn-valider btn-suspend-creation">
                                            suspendre
                                        </button>
                                    </div>
                                    <div class="add-campaign-folder-error"></div>
                                </div>
                            </div>
                        </div>
                    </div>             
                </section>
                <input id="new_folder_link" type="hidden" value="{{ path("admin_communication_emailing_compaign_new_folder") }}">
                <input type="hidden" name="replicate" value="{{ path("admin_communication_emailing_compaign_replicate") }}">
                <input type="hidden" name="rename" value="{{ path("admin_communication_emailing_compaign_rename") }}">
                <input type="hidden" name="filtered" value="{{ path("admin_communication_emailing_compaign_filter") }}">
                <input type="hidden" name="delete-campaign-link" value="{{ path("admin_communication_emailing_compaign_delete") }}">
            </div>
        </div>

        <div class = "row separator"></div>
    </main>

{% endblock %}

{% block footer %}
    {% embed 'AdminBundle::footer.html.twig' %}
        {% block javascripts %}
            {{ parent() }}
            <script src="{{ asset('js/admin-parameters-contents.js') }}"></script>
            <script src="{{ asset('js/admin-emailing-campaign.js') }}"></script>                 
        {% endblock %}
    {% endembed %}
{% endblock %}